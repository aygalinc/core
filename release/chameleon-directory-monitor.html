
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-04-14
 Rendered using Maven Reflow Skin 1.0.0 (http://andriusvelykis.github.com/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Configure and use deployment facilities of Chameleon | OW2 Chameleon - Core</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="./css/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />
		
		<link href="http://yandex.st/highlightjs/7.3/styles/github.min.css" rel="stylesheet" />
		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		
<link rel="stylesheet" href="css/font-awesome.css"/>
<link rel="stylesheet" href="css/orange.css" media="screen" type="text/css"/>
<link rel="stylesheet" href="css/style.css" media="screen" type="text/css"/>
	</head>

	<body class="page-chameleon-directory-monitor project-chameleon-core" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top navbar-inverse">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html"><span class="color-highlight">OW2 Chameleon</span> ~ Core</a>
					<div class="nav-collapse">
						<ul class="nav pull-right">
							<li><a href="downloads.html" title="Download">Download </a></li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="chameleon-quickstart.html" title="Quickstart">Quickstart </a></li>
									<li><a href="chameleon-structure.html" title="Structure">Structure </a></li>
									<li><a href="chameleon-configuration.html" title="Configuration">Configuration </a></li>
									<li class="active"><a href="" title="Deployment">Deployment </a></li>
									<li><a href="chameleon-vm-args.html" title="JVM Arguments">JVM Arguments </a></li>
									<li><a href="chameleon-writing-your-own-deployer.html" title="Extend Deployment">Extend Deployment </a></li>
									<li><a href="chameleon-package.html" title="Package your Chameleon">Package your Chameleon </a></li>
									<li><a href="chameleon-service.html" title="Run as service">Run as service </a></li>
									<li><a href="apidocs/index.html" title="API">API </a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="contribution.html" title="Contribute">Contribute </a></li>
									<li><a href="source-repository.html" title="Sources">Sources </a></li>
									<li><a href="http://github.com/ow2-chameleon/core/issues/" title="Issues" class="externalLink">Issues </a></li>
									<li><a href="http://github.com/ow2-chameleon/core" title="Fork on GitHub" class="externalLink">Fork on GitHub </a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="page-header">
 <h1 id="configure_and_use_deployment_facilities_of_chamele">Configure and use deployment facilities of Chameleon</h1>
</div> 
<p>Chameleon provides very simple but powerful deployment facilities:</p> 
<ul> 
 <li>Monitored directories tracking file changes</li> 
 <li>Automatic deployment of bundles</li> 
 <li>Support of <em>cfg</em> files to ease the interactions with the OSGi configuration admin</li> 
</ul> 
<h2 id="monitored_directories">Monitored directories</h2> 
<p>The <code>runtime</code> and <code>application</code> directories can be monitored, reflecting changes immediately in the framework. For example new bundle placed in such folder would be installed and started (if needed), while deleted bundle file would uninstall the bundle.</p> 
<p>By default only the <code>application</code> folder is monitored. This is configurable from the <code>conf/chameleon.properties</code> file:</p> 
<pre><code># Enables / disables the monitoring of the runtime and application directories.
chameleon.runtime.monitoring = false
chameleon.application.monitoring = true
</code></pre> 
<p>The directory changes are retrieve periodically. The polling period is also configured from the <code>conf/chameleon.properties</code> file.</p> 
<pre><code># Configure the monitoring (i.e. polling) period in milliseconds
chameleon.monitoring.period = 2000
</code></pre> 
<h2 id="bundle_deployment">Bundle deployment</h2> 
<p>Of course, Chameleon handles OSGi bundles. All jar files from the <code>runtime</code> and <code>application</code> directories are installed and started (if needed).</p> 
<p>When a new bundle is installed, Chameleon tries to resolved unresolved bundles.</p> 
<p>In a monitored directory:</p> 
<ul> 
 <li>new jar files are installed and started</li> 
 <li>updated jar files updates the corresponding bundles</li> 
 <li>jar files deletion uninstalls the corresponding bundles</li> 
</ul> 
<h2 id="configuration_deployment">Configuration deployment</h2> 
<p>Configuration files are plain property files (<code>java.util.Property</code>). The format is very simple:</p> 
<pre><code>file ::= ( header | comment ) *
header ::= &lt;header&gt; ( ':' | '=' ) &lt;value&gt; ( '\&lt;nl&gt; &lt;value&gt; ) *
comment ::= '#' &lt;any&gt;
</code></pre> 
<p>Notice that this model only supports string properties. For example:</p> 
<pre><code># default port
ftp.port = 21
</code></pre> 
<p>Configuration file names are related to the PID and factory PID. The structure of the file name is as follows:</p> 
<pre><code>filename ::= &lt;pid&gt; ( '-' &lt;subname&gt; )? '.cfg'
</code></pre> 
<p>If the form is 
 <pid>
   .cfg, the file contains the properties for a Managed Service. The 
  <pid>
    is then the PID of the Managed Service. See the Configuration Admin service for details. 
  </pid> 
 </pid></p> 
<p>When a Managed Service Factory is used, the situation is different. The 
 <pid>
   part then describes the PID of the Managed Service Factory. You can pick any 
  <subname>
    , this bundle will then create an instance for the factory for each unique name. For example: 
  </subname> 
 </pid></p> 
<pre><code>com.acme.xyz.cfg // configuration for Managed Service
// com.acme.xyz
com.acme.abc-default.cfg // Managed Service Factory,
// creates an instance for com.acme.abc
</code></pre> 
<p>In a monitored directory:</p> 
<ul> 
 <li>new cfg files are pushed to the configuration admin</li> 
 <li>updated cfg files updates the corresponding configurations</li> 
 <li>cfg files deletion removes the corresponding configurations</li> 
</ul> 
<h2 id="deployment_order">Deployment order</h2> 
<p>Artifacts from the <code>runtime</code> folder are managed before the artifacts from the <code>application</code> folder.</p> 
<h2 id="adding_monitored_directory_at_runtime">Adding monitored directory at runtime</h2> 
<p>You can ask Chameleon to monitor new directories at runtime using the <code>org.ow2.chameleon.core.services.Watcher</code> service. By calling the <code>add</code> method you add a new directory to the watched list. However, if the <code>add</code> method has returned <code>true</code>, do not forget to call <code>removeAndStopIfNeeded</code> on it.</p>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#configure_and_use_deployment_facilities_of_chamele" title="Configure and use deployment facilities of Chameleon">Configure and use deployment facilities of Chameleon <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#monitored_directories" title="Monitored directories">Monitored directories</a>
		<li><a href="#bundle_deployment" title="Bundle deployment">Bundle deployment</a>
		<li><a href="#configuration_deployment" title="Configuration deployment">Configuration deployment</a>
		<li><a href="#deployment_order" title="Deployment order">Deployment order</a>
		<li><a href="#adding_monitored_directory_at_runtime" title="Adding monitored directory at runtime">Adding monitored directory at runtime</a>
				<li class="divider"></li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li>
							<a href="./" title="Home">Home </a>
						</li>
						<li>
							<a href="http://github.com/ow2-chameleon/core" title="GitHub project" class="externalLink">GitHub project </a>
						</li>
						<li>
							<a href="github-report.html" title="Release notes">Release notes </a>
						</li>
						<li class="nav-header">Download</li>
						<li>
							<a href="downloads.html" title="Download">Download </a>
						</li>
						<li>
							<a href="license.html" title="License">License </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Contribute</li>
						<li>
							<a href="contribution.html" title="Contribute">Contribute </a>
						</li>
						<li>
							<a href="source-repository.html" title="Sources">Sources </a>
						</li>
						<li>
							<a href="http://github.com/ow2-chameleon/core/issues/" title="Issues" class="externalLink">Issues </a>
						</li>
						<li>
							<a href="http://github.com/ow2-chameleon/core" title="Fork on GitHub" class="externalLink">Fork on GitHub </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Documentation</li>
						<li>
							<a href="chameleon-quickstart.html" title="Quickstart">Quickstart </a>
						</li>
						<li>
							<a href="chameleon-structure.html" title="Structure">Structure </a>
						</li>
						<li>
							<a href="chameleon-configuration.html" title="Configuration">Configuration </a>
						</li>
						<li class="active">
							<a href="#" title="Deployment">Deployment </a>
						</li>
						<li>
							<a href="chameleon-vm-args.html" title="JVM Arguments">JVM Arguments </a>
						</li>
						<li>
							<a href="chameleon-writing-your-own-deployer.html" title="Extend Deployment">Extend Deployment </a>
						</li>
						<li>
							<a href="chameleon-package.html" title="Package your Chameleon">Package your Chameleon </a>
						</li>
						<li>
							<a href="chameleon-service.html" title="Run as service">Run as service </a>
						</li>
						<li>
							<a href="apidocs/index.html" title="API">API </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-description">
					<blockquote><span class="color-highlight">OW2 Chameleon</span> ~ core proposes a minimal OSGi distribution used to structure OSGi applications.</blockquote>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2009-2014 <a href="https://github.com/ow2-chameleon/core">OW2 Chameleon</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 1.0.5. </span><span class="publishDate">Last Published: 2014-04-14. </span></p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<!-- Fallback jQuery loading from Google CDN:
	     http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go -->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript">
		if (typeof jQuery == 'undefined')
		{
			document.write(unescape("%3Cscript src='./js/jquery-1.8.3.min.js' type='text/javascript'%3E%3C/script%3E"));
		}
	</script>
	
	<script src="./js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>
	<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	
	</body>
</html>
